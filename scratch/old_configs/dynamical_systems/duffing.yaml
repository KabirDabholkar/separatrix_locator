function :
  _target_  : compose.compose
  _args_    :
    - _target_  : torch.stack
      _partial_ : true
      dim       : -1
    - ${eval:'lambda x:(x[...,1],-x[...,1]+x[...,0]-x[...,0]**3)'}
#    - ${eval:'lambda x:(x[...,1],x[...,0]-x[...,0]**3)'}

IC_distribution_fit: ${.isotropic_gaussians}
#  - ${..IC_distribution}

isotropic_gaussians:
  _target_  : custom_distributions.isotropic_gaussians
  mean      :
    _target_  : torch.zeros
    _args_      :
      - 2
  scales    : ${..scale_range}

scale_range :
  _target_  : numpy.array
#  object  : [1e-3,5e-3,1e-2] #
  object  : [0.1,0.5,1.0,2.0]


IC_distribution:
  _target_  : custom_distributions.makeIIDMultiVariate
  dist  :
    _target_  : torch.distributions.Normal
    loc       : 0
    scale     : 2
  dim : ${..dim}
dist_requires_dim : false

lims:
  x: [-3,3]
  y: [-3,3]
run_traj: true

plot_fixed_points:
  - x : [1,-1]
    y : [0,0]
    marker  : o
    color   : lightgreen
    label   : stable fixed point
    s       : 50
    zorder  : 2
  - x : [0]
    y : [0]
    facecolors :  'none'
    edgecolors :  'C1'
    label   : unstable fixed point
    s       : 100
    linewidths : 2.5
    zorder  : 2

name            : duffing
dim  : 2
equation_latex  : y,-y+x-x^3
